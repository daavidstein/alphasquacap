---
title: "Yearly Ops Chart"
date: "5/2/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### import libs
```{r}
library(here)
library(tidyverse)
library(readxl)
library(lubridate)
```

### import and name data
```{r}
path <- here::here("data", "yearly", "merged_ops_delay.csv")
t <- read.csv(path)
```

### LAX plot
```{r}
ap <- "LAX"

apt <- t %>% filter(airport == ap) %>%
  mutate(exp_date = as_date(2005))

ggplot(apt, aes(x = year)) +
  scale_y_continuous(labels = scales::comma) +
  scale_x_continuous(limits = c(2004, 2018)) +
  geom_ribbon(aes(ymax = Actual_Arrivals, ymin = On_Time_Arrivals), color = "steelblue", fill = "steelblue") +
  geom_vline(xintercept = 2010) +
  labs(title = "Before- and After-Expansion Capacity at LAX", 
       subtitle = "Upper limit of ribbon shows total arrivals / lower limit shows on-time arrivals",
       x = "Year", 
       y = "Arrivals")
```

### ATL plot
```{r}
ap <- "ATL"

apt <- t %>% filter(airport == ap) %>%
  mutate(exp_date = as_date(2005))

ggplot(apt, aes(x = year)) +
  scale_y_continuous(labels = scales::comma) +
  scale_x_continuous(limits = c(2004, 2018)) +
  geom_ribbon(aes(ymax = Actual_Arrivals, ymin = On_Time_Arrivals), color = "steelblue", fill = "steelblue") +
  #geom_line(aes(y = ops)) +
  geom_vline(xintercept = c(2006, 2012)) +
  labs(title = "Before- and After-Expansion Capacity at ATL", 
       subtitle = "Upper limit of ribbon shows total arrivals / lower limit shows on-time arrivals",
       x = "Year", 
       y = "Arrivals")
```

### LGA plot
```{r}
ap <- "LGA"

apt <- t %>% filter(airport == ap) %>%
  mutate(exp_date = as_date(2005))

ggplot(apt, aes(x = year)) +
  scale_y_continuous(labels = scales::comma) +
  scale_x_continuous(limits = c(2004, 2018)) +
  geom_ribbon(aes(ymax = Actual_Arrivals, ymin = On_Time_Arrivals), color = "steelblue", fill = "steelblue") +
  #geom_line(aes(y = ops)) +
  geom_vline(xintercept = c(2010)) +
  labs(title = "Before- and After-Expansion Capacity at LGA", 
       subtitle = "Upper limit of ribbon shows total arrivals / lower limit shows on-time arrivals",
       x = "Year", 
       y = "Arrivals")
```


### ORD plot
```{r}
ap <- "ORD"

apt <- t %>% filter(airport == ap) %>%
  mutate(exp_date = as_date(2005))

ggplot(apt, aes(x = year)) +
  scale_y_continuous(labels = scales::comma) +
  scale_x_continuous(limits = c(2004, 2018)) +
  geom_ribbon(aes(ymax = Actual_Arrivals, ymin = On_Time_Arrivals), color = "steelblue", fill = "steelblue") +
  #geom_line(aes(y = ops)) +
  geom_vline(xintercept = c(2008, 2013, 2015), color = "red") +
  labs(title = "Before- and After-Expansion Capacity at ORD", 
       subtitle = "Upper limit of ribbon shows total arrivals / lower limit shows on-time arrivals",
       x = "Year", 
       y = "Arrivals")
```
